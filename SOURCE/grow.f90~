!======================================================================!
SUBROUTINE GROW
!----------------------------------------------------------------------!
! Update an individual tree.
!----------------------------------------------------------------------!
USE CONSTANTS
USE CONTROL_PARAMETERS
USE TREE
!----------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
Acrown = 10.0      ! Tree crown area                                (m2)
GPP    = 10.0e-6   ! Tree crown gross photosynthesis        (umol/m^2/s)
Resp   = 0.5 * GPP ! Tree maintenance respiration           (umol/m^2/s)
Cup = KGCPERMOL * Acrown * (GPP - Resp) ! Net tree C uptake (kgC/tree/s)
!----------------------------------------------------------------------!
tau = 10.0 * FLOAT (EDPERY * SPERED) ! Structural C residence time   (s)
Clit = Cv / tau  ! Tree structural litter flux              (kgC/tree/s)
!----------------------------------------------------------------------!
dCV = Cup - Clit ! Tree structural carbon time derivative   (kgC/tree/s)
!----------------------------------------------------------------------!
Cv = Cv + DTTR * dCv
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
v = Cv / SIGC ! Stem volume                                        (m^3)
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
! Stem radius                                                        (m)
!----------------------------------------------------------------------!
r = (v / (( FORMF / 3.0) * PI * alpha * 2.0 ** beta)) &
&   ** (1.0 / (2.0 + beta)) 
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
END SUBROUTINE GROW
!======================================================================!
